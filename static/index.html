<!DOCTYPE html>
<html>
<head>
<title>Holistic Home page</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
* {
  box-sizing: border-box;
}

.truncate {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.row::after {
  content: "";
  clear: both;
  display: table;
}

[class*="col-"] {
  padding: 1px;
  float: left;
}

.menu {
    width: 100%;
}

table {
    width: 100%;
}

.font-size-xx-small {
    font-size:xx-small;
}

th {
    color: #ffffff;
}

tr:nth-child(even){background-color: #E7E9EB;}
tr {
    border-bottom: 1px solid #ddd;
}

table tr th {
    background-color: #282A35;
}

.top_menu {
    width: 100%;
    background-color: grey;
    overflow: hidden;
}

.button {
  padding: 5px;
  margin-bottom: 5px;
  color: black;
  background-color: white;
  border: 1px solid black;
}

.spacer {
  padding: 5px;
  margin-bottom: 5px;
}

.terminal-output {
    background-color: black;
    color: white;
}

.top_navigation_button {
  padding: 5px;
  color: black;
  background-color: white;
  border: 1px solid black;
}

.button:hover {
    background-color: black;
    color: #ffffff;
}

.enabled {
    background-color: black;
    color: #ffffff;
}

[class*="col-"] {
  width: 100%;
}

@media only screen and (min-width: 700px) {
  .col-s-1 {width: 8.33%;}
  .col-s-2 {width: 16.66%;}
  .col-s-3 {width: 25%;}
  .col-s-4 {width: 33.33%;}
  .col-s-5 {width: 41.66%;}
  .col-s-6 {width: 50%;}
  .col-s-7 {width: 58.33%;}
  .col-s-8 {width: 66.66%;}
  .col-s-9 {width: 75%;}
  .col-s-10 {width: 83.33%;}
  .col-s-11 {width: 91.66%;}
  .col-s-12 {width: 100%;}
}
@media only screen and (min-width: 1000px) {
  .col-1 {width: 8.33%;}
  .col-2 {width: 16.66%;}
  .col-3 {width: 25%;}
  .col-4 {width: 33.33%;}
  .col-5 {width: 41.66%;}
  .col-6 {width: 50%;}
  .col-7 {width: 58.33%;}
  .col-8 {width: 66.66%;}
  .col-9 {width: 75%;}
  .col-10 {width: 83.33%;}
  .col-11 {width: 91.66%;}
  .col-12 {width: 100%;}
}
</style>
</head>
<body>
<div class="row">
    <div id="header" class="col-12 col-s-12"></div>
</div>
<div class="row">
  <div id="main" class="col-12 col-s-12"></div>
</div>
<div class="row">
    <div id="footer" class="col-12 col-s-12" style="position: absolute; bottom:0;"></div>
</div>
</body>

<script>
    var build_step_status_lookup = {};
    var build_step_status_name_lookup = {};
    var build_step_group_lookup = {};
    var build_step_group_name_lookup = {};
    var build_step_lookup = {};
    var build_step_name_lookup = {};

    var current_branch_instance_step_log_id = 0;
    var current_branch_instance_id = 0;
    var PAGE_SIZE = 10;
    var breadcrumbs = [];

    var url = 'https://' + location.hostname + ':5001/webserver_api';
    var encodeHTMLText = function(text) {
        text = encodeURIComponent(text);
        text = text.replaceAll("%20", "\u00A0");
        text = text.replaceAll("%3A", "\u003A");
        text = text.replaceAll("%2F", "\u002F");
        text = text.replaceAll("%3E", "\u003E");
        return text;
    }

    var create_linebreak = function() {
        var element = document.createElement("br");
        return element;
    }

    var reset_view_state = function() {
        current_branch_instance_step_log_id = 0;
        current_branch_instance_id = 0;
    }
    
    var removeAllChildElements = function(element) {
        if(!element) {
            return;
        }

        if(element == null) {
            return;
        }

        while (element.firstChild) {
            element.removeChild(element.lastChild);
        }

        return;
    }

    var send_http_request = function(params, callback_function) {
        if(!params["[queue]"]) {
            console.error("params did not have [queue]: " + JSON.stringify(params));
            return
        }

        if(!params["[queue_mode]"]) {
            params["[queue_mode]"] = "PushFront";
        }

        var http = new XMLHttpRequest();
        http.onreadystatechange = function() { 
            if (http.readyState == 4) {
                var result = {};
                try {
                    result = JSON.parse(http.responseText);
                    result["[http_status]"] = http.status;
                    callback_function(result);
                    
                    if(result["[errors]"]) {
                        console.error(JSON.stringify(result));
                    } else {
                        console.log(JSON.stringify(result));
                    }
                } catch(ex) {
                    result = {};
                    result["[queue]"] = "unknown"
                    result["[errors]"] = [ex.toString()];
                    result["[http_status]"] = http.status;
                    callback_function(result);
                    console.error(JSON.stringify(result));
                    throw ex;
                }
            }
        }
        http.open('POST', url + "/" + params["[queue]"], true);
        http.setRequestHeader('Content-Type', 'application/json');
        http.send(JSON.stringify(params));
    }

    var navigate_to_page = function(method, params) {
        var breadcrumb = {};
        breadcrumb["function"] = method;
        breadcrumb["params"] = params;
        breadcrumbs.push(breadcrumb);
        
        console.log("navigating to page with params:");
        console.log(method.name);
        console.log(params);
        method(params);
    }

    var refresh_page = function(method, params) {
        if(breadcrumbs.length == 0) {
            return;
        }

        var destination = breadcrumbs[breadcrumbs.length-1];
        var destination_function = destination["function"];
        var destination_params = destination["params"];
        
        if(method.toString() !== destination_function.toString() && JSON.stringify(params) !== JSON.stringify(destination_params)) {
            return
        }

        destination_function(destination_params);
    }

    var navigate_back = function() {
        if(breadcrumbs.length <= 1) {
            return;
        }

        var destination = breadcrumbs[breadcrumbs.length-2];
        var destination_function = destination["function"];
        var destination_params = destination["params"];
        breadcrumbs.pop();

        destination_function(destination_params);
    }

    var navigate_to_page_function = function(method, params) {
        var _method = method;
        var _params = params;
        var f = function() {
            navigate_to_page(_method, _params);
        }
        return f;
    }

    var navigate_back_function = function() {
        var f = function() {
            navigate_back();
        }
        return f;
    }

    var refresh_page_function = function(method, params) {
        var _method = method;
        var _params = params;
        var f = function() {
            refresh_page(_method, _params);
        }
        return f;
    }

    var crud_record = function(mode, table_name, page_index, result) {
        table_name = table_name.replace(/\\\"/g, "\"");
        var temp_message_type = "";
        if(mode == "update") {
            temp_message_type = "UpdateRecord_" + decodeURIComponent(table_name);
        } else if(mode == "create") {
            temp_message_type = "CreateRecord_" + decodeURIComponent(table_name);
        } else if(mode == "delete") {
            temp_message_type = "UpdateRecord_" + decodeURIComponent(table_name);
        }

        var params = {"[queue]":temp_message_type, "data":result};
        var callback_function = function(result) {
            if(result["[errors]"]) {
                return;
            }
            
            navigate_back();
        }
        send_http_request(params, callback_function);
    }

    var record_before = null;

    var redraw_record_page = function(table_name, page_index, mode, schema, record) {
        main_content = document.getElementById("main");
        removeAllChildElements(main_content);
        
        const title = document.createElement("h2");
        title.setAttribute("tabindex", "0");
        title.setAttribute("id", "content_heading");
        const title_text = document.createTextNode(encodeURIComponent(table_name) + " record");
        title.appendChild(title_text);
        main_content.appendChild(title);
        document.getElementById("content_heading").focus();

        var top_back_button = document.createElement("button");
        top_back_button.setAttribute("class", "button");
        top_back_button.setAttribute("id", "backRecordButton");
        var top_back_button_text = document.createTextNode("back");
        top_back_button.appendChild(top_back_button_text);

        top_back_button.onclick = navigate_back_function();

        var bottom_back_button = document.createElement("button");
        bottom_back_button.setAttribute("class", "button");
        bottom_back_button.setAttribute("id", "backRecordButton");
        var bottom_back_button_text = document.createTextNode("back");
        bottom_back_button.appendChild(bottom_back_button_text);
        bottom_back_button.onclick = navigate_back_function();

        var schema_keys =  Object.keys(schema);
        var column_names_sorted = [];

        for(var i=0; i < schema_keys.length; i++) {
            var schema_definition = schema[schema_keys[i]];
            if(schema_definition["auto_increment"] && schema_definition["primary_key"]) {
                column_names_sorted.push(schema_keys[i]);
            }
        }
        
        {
            var non_auto_increment_primary_keys = [];
            for(var i=0; i < schema_keys.length; i++) {
                var schema_definition = schema[schema_keys[i]];
                if(!(schema_definition["auto_increment"]) && schema_definition["primary_key"]) {
                    non_auto_increment_primary_keys.push(schema_keys[i]);
                }
            }
            non_auto_increment_primary_keys.sort();

            for(var i=0; i < non_auto_increment_primary_keys.length; i++) {
                column_names_sorted.push(non_auto_increment_primary_keys[i]);
            }
        }

        {
            var foreign_keys = [];
            for(var i=0; i < schema_keys.length; i++) {
                var schema_definition = schema[schema_keys[i]];
                if(schema_definition["foreign_key"]) {
                    foreign_keys.push(schema_keys[i]);
                }
            }
            foreign_keys.sort();

            for(var i=0; i < foreign_keys.length; i++) {
                column_names_sorted.push(foreign_keys[i]);
            }
        }

        if(schema["name"]) {
            column_names_sorted.push("name");
        }

        {
            var other_fields = [];
            for(var i=0; i < schema_keys.length; i++) {
                var schema_column_name = schema_keys[i];
                var schema_definition = schema[schema_column_name];
                
                if(schema_definition["primary_key"] || schema_definition["foreign_key"]) {
                    continue
                }

                if(schema_column_name == "name" ||
                    schema_column_name == "active" ||
                    schema_column_name == "archieved" || 
                    schema_column_name == "last_modified_date" || 
                    schema_column_name == "created_date" || 
                    schema_column_name == "archieved_date" ) {
                    continue
                }
                other_fields.push(schema_column_name);
            }
            other_fields.sort();

            for(var i=0; i < other_fields.length; i++) {
                column_names_sorted.push(other_fields[i]);
            }
        }

        if(schema["active"]) {
            column_names_sorted.push("active");
        }

        if(schema["archieved"]) {
            column_names_sorted.push("archieved");
        }

        if(schema["last_modified_date"]) {
            column_names_sorted.push("last_modified_date");
        }

        if(schema["created_date"]) {
            column_names_sorted.push("created_date");
        }

        if(schema["archieved_date"]) {
            column_names_sorted.push("archieved_date");
        }

        const table = document.createElement("table");

        const rowHeader = document.createElement("tr");
       
        const atrribute_label = document.createElement("th");
        const atrribute_label_text = document.createTextNode("attribute");
        atrribute_label.appendChild(atrribute_label_text);

        const value_label = document.createElement("th");
        const value_label_text = document.createTextNode("value");
        value_label.appendChild(value_label_text);
        
        rowHeader.appendChild(atrribute_label);
        rowHeader.appendChild(value_label);
        table.appendChild(rowHeader);

        var foreign_keys_buttons = [];

        for(var i = 0; i < column_names_sorted.length; i++) {
            const columName = column_names_sorted[i].split('').join('');
            const columnNameSchema = schema[columName];

            if(columnNameSchema["foreign_keys"]) {
            {
                for(var j=0; j<columnNameSchema["foreign_keys"].length; j++) {
                    {
                        var current_foreign_key = columnNameSchema["foreign_keys"][j];
                        var current_table_name = current_foreign_key["table_name"];
                        var current_column = current_foreign_key["column_name"];

                        var _button = document.createElement("button");
                        _button.setAttribute("class", "button");
                        var button_text = document.createTextNode(current_table_name);
                        _button.appendChild(button_text);

                        var _input_params = {};
                        _input_params["table_name"] = current_table_name;
                        _input_params["page_index"] = 0;
                        
                        var _input_array = [];
                        var _where_field = {};
                        
                        _where_field["column"] = current_column;
                        _where_field["logic"] = "=";
                        _where_field["value"] = record[current_column];
                        
                        _input_array.push(_where_field);
                        _input_params["where_fields"] = _input_array;
                        
                        var _orderby = [];
                        var _orderbyfield = {};
                        _orderbyfield["created_date"] = "descending";
                        _orderby.push(_orderbyfield);
                        _input_params["order_by"] = _orderby;
                        
                        var _function = navigate_to_page_function(navigate_to_view_table, _input_params);
                        _button.onclick = _function;

                        foreign_keys_buttons.push(_button);
                    }
                }
            }
        }

            if(mode == "create") {
                if(columnNameSchema["primary_key"] && columnNameSchema["auto_increment"]) {
                    continue;
                }

                if(columName == "last_modified_date" ||
                    columName == "created_date" || 
                    columName == "archieved_date") {
                    continue;
                }
            } 

            const rowData = document.createElement("tr");
            
            const label = document.createElement("td");
            const labelText = document.createTextNode(columName);
            label.appendChild(labelText);
            rowData.appendChild(label);

            const data = document.createElement("td");
             if(mode == "view" || mode == "update" || mode == "create") {
                var editable = true;

                if(mode == "view") {
                    editable = false;
                }

                if(columName == "last_modified_date" ||
                    columName == "created_date" || 
                    columName == "archieved_date") {
                    editable = false;
                }

                if(columnNameSchema["primary_key"] && columnNameSchema["auto_increment"]){
                    editable = false;
                }
                
                if(editable) {
                    if(columnNameSchema["type"] == "bool" || columnNameSchema["type"] == "*bool") {
                        var trueButton =  document.createElement("button");
                        trueButton.setAttribute("id", columName + "_true");
                        
                        if(mode == "update") {
                            trueButton.setAttribute("value", record[columName]);
                        } else if(mode == "create") {
                            trueButton.setAttribute("value", columnNameSchema["default"]);
                        }
                        
                        var trueButtonText = document.createTextNode("true");
                        trueButton.appendChild(trueButtonText);

                        var falseButton =  document.createElement("button");
                        falseButton.setAttribute("id", columName + "_false");
                        var bool_value = null;
                        if(mode == "update") {
                            falseButton.setAttribute("value", record[columName]);
                            bool_value = record[columName];
                        } else if(mode == "create") {
                            falseButton.setAttribute("value", columnNameSchema["default"]);
                            bool_value = columnNameSchema["default"];
                        }

                        var falseButtonText = document.createTextNode("false");
                        falseButton.appendChild(falseButtonText);

                        if(bool_value == true) {
                            trueButton.setAttribute("class", "button enabled");
                            trueButton.setAttribute("disabled", true);
                            falseButton.setAttribute("class", "button");
                            falseButton.onclick = function() {
                                record[columName] = false;
                                redraw_record_page(table_name, page_index, mode, schema, record);
                            }
                        } else if(bool_value == false) {
                            trueButton.setAttribute("class", "button");
                            trueButton.onclick = function() {
                                record[columName] = true;
                                redraw_record_page(table_name, page_index, mode, schema, record);
                            }
                            falseButton.setAttribute("class", "button enabled");
                            falseButton.setAttribute("disabled", true);
                        }
                        
                        data.appendChild(trueButton);
                        data.appendChild(falseButton);
                    } else {
                        {
                            var inputData = document.createElement("input");
                            inputData.setAttribute("id", columName);
                            if(mode == "update") {
                                inputData.value = record[columName];
                                inputData.setAttribute("value", record[columName]);
                            } else if(mode == "create") {
                                inputData.value = columnNameSchema["default"];
                                inputData.setAttribute("value", columnNameSchema["default"]);
                            }

                            var key_up_function = function(event) {
                                var target_column_name = columName;
                                var x = function() {
                                    record[target_column_name] = document.getElementById(target_column_name).value
                                }
                                x();
                            }
                            
                            inputData.onkeyup = key_up_function;
                            data.appendChild(inputData);
                        }
                    }
                }
                else {
                    {
                        var inputData = document.createElement("input");
                        inputData.setAttribute("id", columName);
                        inputData.setAttribute("disabled", true);
                        if(mode == "update" || mode == "view") {
                            inputData.setAttribute("value", record[columName]);
                            inputData.value = record[columName];
                        } else if(mode == "create") {
                            inputData.setAttribute("value", columnNameSchema["default"]);
                            inputData.value = columnNameSchema["default"];
                        }
                        data.appendChild(inputData);
                    }
                }
            } 
           
            rowData.appendChild(data);
            table.appendChild(rowData);
        }

       

        main_content.appendChild(top_back_button);
        main_content.appendChild(create_linebreak());
        for(j=0; j<foreign_keys_buttons.length;j++) {
            main_content.appendChild(foreign_keys_buttons[j]);
        }

        main_content.appendChild(table);
        main_content.appendChild(bottom_back_button);


        if(mode == "update" || mode == "create") {
            var saveButton = document.createElement("button");
            saveButton.setAttribute("class", "button");
            saveButton.setAttribute("id", "saveRecordButton");
            var saveButtonText = document.createTextNode("save");
            saveButton.appendChild(saveButtonText);
            saveButton.onclick = function() {
                save_result = {};
                values_changed_count = 0;
                for(var i = 0; i < column_names_sorted.length; i++) {
                    var column_name = column_names_sorted[i];
                    var schema_for_column = schema[column_name];

                    if(column_name == "last_modified_date" ||
                       column_name == "created_date" || 
                       column_name == "archieved_date") {
                        continue;
                    }

                    if(mode == "create") {
                        if(column_name == "active" ||
                           column_name == "archieved") {
                            continue;
                        }
                    }

                    if(mode == "create" && schema_for_column["primary_key"] && schema_for_column["auto_increment"]) {
                        continue;
                    }
                  
                    if(schema_for_column["type"] == "bool" || schema_for_column["type"] == "*bool") {
                        var true_element = document.getElementById(column_name + "_true");
                        var false_element = document.getElementById(column_name + "_false");
                        if(false_element.getAttribute("disabled")) {
                            if(record_before[column_name] != false) {
                                save_result[column_name] = false;
                                values_changed_count++;
                            }
                        } else {
                            if(record_before[column_name] != true) {
                                save_result[column_name] = true;
                                values_changed_count++;
                            }
                        }
                    } else if(schema_for_column["type"] == "string" || schema_for_column["type"] == "*string"){
                        var string_element = document.getElementById(column_name);
                        var new_string_value = string_element.value;
                        if(record_before[column_name] != new_string_value) {
                            save_result[column_name] = new_string_value;
                            values_changed_count++;
                        }
                    } else if (schema_for_column["type"] == "uint" ||
                               schema_for_column["type"] == "uint8" || 
                               schema_for_column["type"] == "*uint8" || 
                               schema_for_column["type"] == "uint16" || 
                               schema_for_column["type"] == "*uint16" ||
                               schema_for_column["type"] == "uint32" || 
                               schema_for_column["type"] == "*uint32" ||
                               schema_for_column["type"] == "uint64" || 
                               schema_for_column["type"] == "*uint64" ||
                               schema_for_column["type"] == "int" ||
                               schema_for_column["type"] == "int8" || 
                               schema_for_column["type"] == "*int8" || 
                               schema_for_column["type"] == "int16" || 
                               schema_for_column["type"] == "*int16" ||
                               schema_for_column["type"] == "int32" || 
                               schema_for_column["type"] == "*int32" ||
                               schema_for_column["type"] == "int64" || 
                               schema_for_column["type"] == "*int64") {
                        var number_element = document.getElementById(column_name);
                        var new_value = Number.parseInt(number_element.value, 10);

                        if(record_before[column_name] != new_value ) {
                            values_changed_count++;
                        }

                        if(record_before[column_name] != new_value || (schema_for_column["primary_key"] ||  schema_for_column["foreign_key"])) {
                            save_result[column_name] = new_value;
                        }
                    }
                }

                if(values_changed_count > 0) {
                    crud_record(mode, table_name, page_index, save_result);
                }  else {
                    var _params = {};
                    _params["table_name"] = table_name;
                    _params["page_index"] = page_index;
                    navigate_to_view_table(_params);
                }
            } 
            
            main_content.appendChild(saveButton);

            if(mode == "update") {
                var deleteButton = document.createElement("button");
                deleteButton.setAttribute("class", "button");
                deleteButton.setAttribute("id", "deleteRecordButton");
                var deleteButtonText = document.createTextNode("delete");
                deleteButton.appendChild(deleteButtonText);
                deleteButton.onclick = function() {
                    save_result = {};
                    for(var i = 0; i < column_names_sorted.length; i++) {
                        var column_name = column_names_sorted[i];
                        var schema_for_column = schema[column_name];

                        if(column_name !== "archieved") {
                            if(!(schema_for_column["primary_key"] || schema_for_column["foreign_key"])) {
                                continue;
                            }
                        }

                        if((schema_for_column["type"] == "bool" || schema_for_column["type"] == "*bool") && column_name === "archieved") {
                            save_result[column_name] = true;
                        } else if (schema_for_column["type"] == "uint" ||
                                schema_for_column["type"] == "uint8" || 
                                schema_for_column["type"] == "*uint8" || 
                                schema_for_column["type"] == "uint16" || 
                                schema_for_column["type"] == "*uint16" ||
                                schema_for_column["type"] == "uint32" || 
                                schema_for_column["type"] == "*uint32" ||
                                schema_for_column["type"] == "uint64" || 
                                schema_for_column["type"] == "*uint64" ||
                                schema_for_column["type"] == "int" ||
                                schema_for_column["type"] == "int8" || 
                                schema_for_column["type"] == "*int8" || 
                                schema_for_column["type"] == "int16" || 
                                schema_for_column["type"] == "*int16" ||
                                schema_for_column["type"] == "int32" || 
                                schema_for_column["type"] == "*int32" ||
                                schema_for_column["type"] == "int64" || 
                                schema_for_column["type"] == "*int64") {
                            var number_element = document.getElementById(column_name);
                            var new_value = Number.parseInt(number_element.value, 10);

                            if(schema_for_column["primary_key"] || schema_for_column["foreign_key"]) {
                                save_result[column_name] = new_value;
                            }
                        }
                    }
                    crud_record("delete", table_name, page_index, save_result);
                }
                main_content.appendChild(deleteButton);
            }
        }
    }

    var navigate_to_manage_record = function(input_params) {
        reset_view_state();
        var table_name = input_params["table_name"];
        var page_index = input_params["page_index"];
        var where_fields = input_params["where_fields"];
        var mode = input_params["mode"];

        table_name = table_name.replace(/\\\"/g, "\"");
        document.title = "Holistic " + mode + " record " + table_name + " page";
        var params = {};

        if(mode !== "create") {
            var temp_message_type = "ReadRecords_" + decodeURIComponent(table_name);
            params = {"[queue]":temp_message_type, "[where_fields]":where_fields, "[include_schema]":true};
        } else {
            var temp_message_type = "GetSchema_" + decodeURIComponent(table_name);
            params = {"[queue]":temp_message_type};
        }
      
        var callback_function = function(result) {
            if(result["[errors]"]) {
                return;
            }

            if(mode !== "create") {
                record_before = JSON.parse(JSON.stringify(result["data"][0]));
                redraw_record_page(table_name, page_index, mode, result["schema"], result["data"][0]);
            } else {
                record_before = {};
                var new_record = {};
                redraw_record_page(table_name, page_index, mode, result["data"], new_record);
            }
        }
        console.log(params);
        send_http_request(params, callback_function);
    }

    var display_number_of_records_for_table = function(params, number_of_records) {
        var pages = document.getElementById("pages");
        if(!pages) {
            return;
        }
        removeAllChildElements(pages);

        console.log(params);
        var table_name = params["table_name"];
        var page_index = params["page_index"];

        var min_page_index = 0;
        var max_page_index = 0;
        if (number_of_records % PAGE_SIZE == 0) {
            max_page_index = (number_of_records / PAGE_SIZE) - 1;
        } else {
            max_page_index = (number_of_records / PAGE_SIZE);
        }
        max_page_index = parseInt(max_page_index, 10);

        var event_function = function(_table_name, _i) {
            var __table_name = _table_name;
            var __i = _i;
            var __clicked = false;
            var func = function() {
                if(__clicked) {
                    return;
                }
                __clicked = true;
                var _params = {};
                _params["table_name"] = __table_name;
                _params["page_index"] = __i;
                navigate_to_page(navigate_to_view_table, _params);
            }
            return func;
        }

        var previous_min_index = page_index - 10;
        if(previous_min_index < 0) {
            previous_min_index = 0;
        }

        var next_max_index = page_index + 10;
        if(next_max_index > max_page_index) {
            next_max_index = max_page_index;
        }

        {
            var div = document.createElement("div");
            div.setAttribute("class", "spacer col-12 col-s-12");
            var record_index_details_span = document.createElement("span");
            
            var record_count_text_value = ((page_index*PAGE_SIZE)+1) + " of " + number_of_records;
          
            if(number_of_records == 0) {
                record_count_text_value = "no records found";
            } else if(number_of_records == 1) {
                record_count_text_value += " record";
            } else {
                record_count_text_value += " records";
            }
            
            var record_count_span = document.createElement("span");
            var record_count_text = document.createTextNode(record_count_text_value); 
            record_count_span.appendChild(record_count_text);
            record_count_span.setAttribute("style", "float: right;");

            var page_label = document.createElement("span");
            var page_label_text = document.createTextNode("page: ");
            page_label.appendChild(page_label_text);

            var page_input_span = document.createElement("span");
            page_input_span.setAttribute("style", "text-align: center;");

            var page_input = document.createElement("input");
            var page_input_size = (max_page_index+1).toString().length;
            page_input.setAttribute("type", "number");
            page_input.setAttribute("value", (page_index+1));
            page_input.setAttribute("maxlength", page_input_size);
            page_input.setAttribute("size", page_input_size);
            page_input.setAttribute("minlength", 1);
            page_input.setAttribute("min", 1);
            page_input.setAttribute("max", (max_page_index+1));
            page_input.setAttribute("id", "current_page_number");
            page_input.setAttribute("table_name", table_name);

            var navigate_page_function = function(event, onchange) {
                if (event.key === "Enter" || onchange) {
                    event.preventDefault();

                    var current_page_element = document.getElementById("current_page_number");
                    if(!current_page_element) {
                        return;
                    }

                    var current_page_value = current_page_element.value;
                    if(!current_page_value) {
                        return;
                    }

                    if(current_page_value === "") {
                        return;
                    }

                    var current_page_value_int = parseInt(current_page_value);
                    if(current_page_value_int <= 0) {
                        current_page_value_int = 1;
                    }

                    if(current_page_value_int > (max_page_index+1)) {
                        current_page_value_int = max_page_index+1;
                    }

                    var current_table_name = current_page_element.getAttribute("table_name");
                    if(!current_table_name) {
                        return;
                    }

                    var _params = {};
                    _params["table_name"] = current_table_name;
                    _params["page_index"] = current_page_value_int-1;
                    navigate_to_view_table(_params);
                }
            }

            page_input.addEventListener("keypress", function(event) {
                navigate_page_function(event, false);
            });

            page_input.addEventListener("change", function(event) {
                navigate_page_function(event, true);
            });


            var page_count_element = document.createElement("span");
            var page_count_element_value =  document.createTextNode(" of " + (max_page_index+1));
            page_count_element.appendChild(page_count_element_value);
            
            page_input_span.appendChild(page_label);
            page_input_span.appendChild(page_input);
            page_input_span.appendChild(page_count_element);


            var spacer = document.createElement("br");

            record_index_details_span.appendChild(page_input_span);
            record_index_details_span.appendChild(record_count_span);
            record_index_details_span.setAttribute("class", "col-12 col-s-12");
            record_index_details_span.setAttribute("style", "text-align: center;");
            
            div.appendChild(record_index_details_span);
            div.appendChild(spacer);
            pages.appendChild(div);
        }

        var page_buttons_added = 0;
        if(page_index != 0) {
            {
                var button = document.createElement("a");
                button.setAttribute("class", "button menu col-1 col-s-1");
                var link = document.createElement("a");
                button.setAttribute("rel", "tag");
                button.setAttribute("href", "#");
                button.addEventListener("click", event_function(table_name, previous_min_index));
                var text = document.createTextNode("<<");
                button.appendChild(text);
                pages.appendChild(button);
                page_buttons_added++;
            }
        }
        
        var number_of_displayed_pages = 0;
        for(var i=page_index; i <= max_page_index; i++) {
            {
                var button = document.createElement("a");
                button.setAttribute("class", "button menu col-1 col-s-1");
                var link = document.createElement("a");
                button.setAttribute("rel", "tag");
                button.setAttribute("href", "#");
                button.addEventListener("click", event_function(table_name, i));
                var text = document.createTextNode(i+1);
                button.appendChild(text);
                pages.appendChild(button);
                page_buttons_added++;
            }
            
            number_of_displayed_pages++;
            if(number_of_displayed_pages >= 10) {
                break;
            }
        }

        if((page_index + 10) < max_page_index) {
            {
                var button = document.createElement("a");
                button.setAttribute("class", "button menu col-1 col-s-1");
                var link = document.createElement("a");
                button.setAttribute("rel", "tag");
                button.setAttribute("href", "#");
                button.addEventListener("click", event_function(table_name, next_max_index));
                var text = document.createTextNode(">>");
                button.appendChild(text);
                pages.appendChild(button);
                page_buttons_added++;
            }
        }

        {
            for(var i=0; i < 12 - page_buttons_added; i++) {
                var div = document.createElement("div");
                div.setAttribute("class", "spacer col-1 col-s-1");
                var spacer = document.createElement("br");
                div.appendChild(spacer);
                pages.appendChild(div);
            }
        }
    }

    var navigate_to_view_table = function(input_params) {
        reset_view_state();

        var table_name = input_params["table_name"];
        var page_index = input_params["page_index"];
        var where_fields = input_params["where_fields"];
        var orderby = input_params["order_by"];
        table_name = table_name.replace(/\\\"/g, "\"");
        document.title = "Holistic View Table " + table_name + " page";
        main_content = document.getElementById("main");

        const title = document.createElement("h2");
        title.setAttribute("tabindex", "0");
        title.setAttribute("id", "content_heading");
        const title_text = document.createTextNode(encodeURIComponent(table_name) + " records");
        title.appendChild(title_text);

        var temp_message_type = "ReadRecords_" + decodeURIComponent(table_name);
        var offset = page_index * PAGE_SIZE;
        var limit = PAGE_SIZE;
        var params = {"[queue]":temp_message_type,"[select_fields]":["[minimal_fields]"],"[include_schema]":true, "[include_count]":true, "[limit]":limit, "[offset]":offset};
        params["table_name"] = table_name.split('').join('');
        params["page_index"] = page_index;
        params["[where_fields]"] = where_fields;
        params["[order_by]"] = orderby;

        var callback_function = function(result) {
            var message_type = Object.keys(result)[0]
            if(result["[errors]"]) {
                return;
            }
            var should_refresh_page = false;
            var foreign_key_query_data = {};

            const top_back_button = document.createElement("button");
            top_back_button.setAttribute("class", "button");
            top_back_button.setAttribute("id", "backRecordButton");
            var top_back_button_text = document.createTextNode("back");
            top_back_button.appendChild(top_back_button_text);
            top_back_button.onclick = navigate_back_function();

            const bottom_back_button = document.createElement("button");
            bottom_back_button.setAttribute("class", "button");
            bottom_back_button.setAttribute("id", "backRecordButton");
            var bottom_back_button_text = document.createTextNode("back");
            bottom_back_button.appendChild(bottom_back_button_text);
            bottom_back_button.onclick = navigate_back_function();

            var payload = result;
            var records = payload["data"];
            var count = payload["count"];

            var schema = result["schema"]; 
            var schema_keys =  Object.keys(schema);
            var column_names_sorted = [];
            for(var i=0; i < schema_keys.length; i++) {
                var schema_definition = schema[schema_keys[i]];
                if(schema_definition["auto_increment"] && schema_definition["primary_key"]) {
                    column_names_sorted.push(schema_keys[i]);
                }
            }
            
            {
                var non_auto_increment_primary_keys = [];
                for(var i=0; i < schema_keys.length; i++) {
                    var schema_definition = schema[schema_keys[i]];
                    if(!(schema_definition["auto_increment"]) && schema_definition["primary_key"]) {
                        non_auto_increment_primary_keys.push(schema_keys[i]);
                    }
                }
                non_auto_increment_primary_keys.sort();

                for(var i=0; i < non_auto_increment_primary_keys.length; i++) {
                    column_names_sorted.push(non_auto_increment_primary_keys[i]);
                }
            }

            {
                var foreign_keys = [];
                for(var i=0; i < schema_keys.length; i++) {
                    var schema_definition = schema[schema_keys[i]];
                    if(schema_definition["foreign_key"]) {
                        foreign_keys.push(schema_keys[i]);
                    }
                }
                foreign_keys.sort();

                for(var i=0; i < foreign_keys.length; i++) {
                    column_names_sorted.push(foreign_keys[i]);
                }
            }

            if(schema["name"]) {
                column_names_sorted.push("name");
            }

            for(var i = 0; i < column_names_sorted.length; i++) {
                if(column_names_sorted[i].indexOf("_status_") !== -1) {
                    should_refresh_page = true;
                }
            }

            const table = document.createElement("table");
            for(var i = 0; i < records.length; i++) {
                var current_record = records[i];
                var column_names = column_names_sorted;
                {
                    if(i == 0) {
                        const rowHeader = document.createElement("tr");
                        for(var j = 0; j < column_names.length; j++) {
                            const currentColumnName = column_names[j];
                            const rowColumnHeader = document.createElement("th");
                            const rowColumnHeaderText = document.createTextNode(currentColumnName);
                            rowColumnHeader.appendChild(rowColumnHeaderText);
                            rowHeader.appendChild(rowColumnHeader);
                        }
                        const rowColumnHeader = document.createElement("th");
                        const rowColumnHeaderText = document.createTextNode("actions");
                        rowColumnHeader.appendChild(rowColumnHeaderText);
                        rowHeader.appendChild(rowColumnHeader);

                        table.appendChild(rowHeader);
                    }
                }

                {
                    const rowData = document.createElement("tr");
                    var identifier = [];
                   
                    for(var j = 0; j < column_names.length; j++) {
                        const currentColumnName = column_names[j];
                        const rowColumnData = document.createElement("td");
                        const rowColumnDataText = document.createTextNode(current_record[currentColumnName]);

                        if(!(schema[currentColumnName]["primary_key"] || schema[currentColumnName]["foreign_key"])) {
                            rowColumnData.appendChild(rowColumnDataText);
                        } else if(schema[currentColumnName]["primary_key"]) {
                            {
                                const editButton = document.createElement("a");
                                editButton.setAttribute("rel", "tag");
                                editButton.setAttribute("href", "#");
                                const editButtonText = document.createTextNode(current_record[currentColumnName]);
                                var edit_function = function (table_name, id) {
                                    var _table_name = table_name.split('').join('');
                                    var _id = Object.assign([], id);
                                    var _page_index = page_index;
                                    var _params = {};
                                    _params["table_name"] = _table_name;
                                    _params["where_fields"] = _id;
                                    _params["mode"] = "update";
                                    console.log(_params);
                                    return navigate_to_page_function(navigate_to_manage_record, _params);
                                }
                                
                                var temp_identifier_array = [];
                                var temp_identifier = {};
                                temp_identifier["column"] = currentColumnName;
                                temp_identifier["value"] = current_record[currentColumnName];
                                temp_identifier["logic"] = "=";
                                temp_identifier_array.push(temp_identifier);
                                identifier.push(temp_identifier);
                                editButton.onclick = edit_function(table_name, Object.assign([], temp_identifier_array));
                                editButton.appendChild(editButtonText);
                                rowColumnData.appendChild(editButton);
                            }
                        } else if(schema[currentColumnName]["foreign_key"]) {
                            {
                                const editButton = document.createElement("a");
                                editButton.setAttribute("rel", "tag");
                                editButton.setAttribute("href", "#");
                                editButton.setAttribute("class", "quick-replace-table-name-" + schema[currentColumnName]["foreign_key_table_name"] + "-column-name-" + currentColumnName + "-id-" + current_record[currentColumnName]);
                                const editButtonText = document.createTextNode("loading...");
                                var edit_function = function (table_name, id) {
                                    var _table_name = table_name.split('').join('');
                                    var _id = Object.assign([], id);
                                    var _params = {};
                                    _params["table_name"] = _table_name;
                                    _params["where_fields"] = _id;
                                    _params["mode"] = "update";
                                    return navigate_to_page_function(navigate_to_manage_record, _params);
                                }

                                var temp_identifier_array = [];
                                var temp_identifier = {};
                                temp_identifier["column"] = currentColumnName;
                                temp_identifier["value"] = current_record[currentColumnName];
                                temp_identifier["logic"] = "=";
                                temp_identifier_array.push(temp_identifier);
                                identifier.push(temp_identifier);
                                editButton.onclick = edit_function(schema[currentColumnName]["foreign_key_table_name"], Object.assign([], temp_identifier_array));
                                editButton.appendChild(editButtonText);
                                rowColumnData.appendChild(editButton);

                                if(!foreign_key_query_data[schema[currentColumnName]["foreign_key_table_name"]]) {
                                    var _data = {};
                                    foreign_key_query_data[schema[currentColumnName]["foreign_key_table_name"]] = _data;
                                }

                                if(!foreign_key_query_data[schema[currentColumnName]["foreign_key_table_name"]]["foreign_key_column_name"]) {
                                    foreign_key_query_data[schema[currentColumnName]["foreign_key_table_name"]]["foreign_key_column_name"] = currentColumnName;
                                }

                                if(!foreign_key_query_data[schema[currentColumnName]["foreign_key_table_name"]]["foreign_key_ids"]) {
                                    var _data2 = [];
                                    foreign_key_query_data[schema[currentColumnName]["foreign_key_table_name"]]["foreign_key_ids"] = _data2;
                                }

                                if(!foreign_key_query_data[schema[currentColumnName]["foreign_key_table_name"]]["foreign_key_ids"].includes(current_record[currentColumnName])) {
                                    foreign_key_query_data[schema[currentColumnName]["foreign_key_table_name"]]["foreign_key_ids"].push(current_record[currentColumnName]);
                                }
                            }
                        }

                        rowData.appendChild(rowColumnData);
                    }
                    const rowColumnData = document.createElement("td");

                    if(table_name === "Branch") {
                        {
                            const branch_id = current_record["branch_id"];
                            const buildButton = document.createElement("button");
                            buildButton.setAttribute("id", "build_branch_id_button_" + branch_id);
                            buildButton.setAttribute("class", "button");
                            const buildButtonText = document.createTextNode("build");
                            var build_function = function (branch_id) {
                                var _id = Object.assign({}, branch_id);
                                var x = function() {
                                    create_record_branch_instance(_id);
                                }
                                return x;
                            }
                            var identifier = {"branch_id":branch_id};
                            buildButton.onclick = build_function(identifier);
                            buildButton.appendChild(buildButtonText);
                            rowColumnData.appendChild(buildButton);
                        }
                    }
                    
                    const viewButton = document.createElement("button");
                    viewButton.setAttribute("class", "button");
                    const viewButtonText = document.createTextNode("view");
                    var view_function = function (id) {
                        var _table_name = table_name.split('').join('');
                        var _id = Object.assign([], id);
                        var _params = {};
                        _params["table_name"] = _table_name;
                        _params["where_fields"] = _id;
                        _params["mode"] = "view"
                        return navigate_to_page_function(navigate_to_manage_record, _params);
                    }
                    viewButton.onclick = view_function(identifier);
                    viewButton.appendChild(viewButtonText);
                    rowColumnData.appendChild(viewButton);

                    const editButton = document.createElement("button");
                    editButton.setAttribute("class", "button");
                    const editButtonText = document.createTextNode("edit");
                    var edit_function = function (id) {
                        var _table_name = table_name.split('').join('');
                        var _id = Object.assign([], id);
                        var _params = {};
                        _params["table_name"] = _table_name;
                        _params["where_fields"] = _id;
                        _params["mode"] = "update";
                        return navigate_to_page_function(navigate_to_manage_record, _params); 
                    }

                    editButton.onclick = edit_function(identifier);
                    editButton.appendChild(editButtonText);
                    rowColumnData.appendChild(editButton);

                    rowData.appendChild(rowColumnData);
                    table.appendChild(rowData);
                }
            }

            const createButton = document.createElement("button");
            createButton.setAttribute("class", "button");
            const createButtonText = document.createTextNode("create");
            createButton.appendChild(createButtonText);

            {
                var _table_name = table_name.split('').join('');
                var _params = {};
                _params["table_name"] = _table_name;
                _params["page_index"] = page_index;
                _params["where_fields"] = null;
                _params["mode"] = "create";
                var create_on_click_function = navigate_to_page_function(navigate_to_manage_record, _params);
                createButton.onclick = create_on_click_function;
            }

            var pages = document.createElement("div");
            pages.setAttribute("id", "pages");

            container_element = document.createElement("div");
            container_element.setAttribute("class", "col-12 col-s-12");
            
            removeAllChildElements(main_content);
            container_element.appendChild(title);
            container_element.appendChild(top_back_button);
            container_element.appendChild(createButton);
            container_element.appendChild(table);
            container_element.appendChild(pages);
           
            container_element.appendChild(bottom_back_button);
            removeAllChildElements(main_content);
            main_content.appendChild(container_element);

            display_number_of_records_for_table(params, count);

            
            document.getElementById("content_heading").focus();

            {
                var foreign_key_table_names = Object.keys(foreign_key_query_data);
                for(var _i = 0; _i < foreign_key_table_names.length; _i++) {
                    var _temp_message_type = "ReadRecords_" + decodeURIComponent(foreign_key_table_names[_i]);
                    var _foreign_key_details = foreign_key_query_data[foreign_key_table_names[_i]];
                    var _foreign_key_column_name = _foreign_key_details["foreign_key_column_name"];
                    var _foreign_key_ids = _foreign_key_details["foreign_key_ids"];
                    var _where_fields_value_array = [];
                    var _where_fields_value = {};
                    _where_fields_value["column"]=_foreign_key_column_name;
                    _where_fields_value["value"]=_foreign_key_ids;
                    _where_fields_value["logic"]="in";
                    _where_fields_value_array.push(_where_fields_value);
                    var _params = {"[queue]":_temp_message_type,"[select_fields]":["[minimal_fields]"],"[include_schema]":true, "[where_fields]":_where_fields_value_array};

                    var _callback_function = function(_result) {
                        var _message_type = Object.keys(_result)[0];
                        if(_result["[errors]"]) {
                            return;
                        }

                        var _payload = _result;
                        var _queue_name = _payload["[queue]"];
                        var _records = _payload["data"];
                        var _table_name = _queue_name.substring(_queue_name.indexOf("_")+1);
                        var _schema = _payload["schema"];
                        var _primary_key_auto_increment = "";

                        var _column_definitions = Object.keys(_schema);
                        for(var _i=0; _i < _column_definitions.length; _i++) {
                            var _current_column_definition = _schema[_column_definitions[_i]];
                            if(!_current_column_definition["primary_key"]) {
                                continue;
                            }

                            if(!_current_column_definition["auto_increment"]) {
                                continue;
                            }

                            _primary_key_auto_increment = _column_definitions[_i];
                            break;
                        }

                        for(var _i=0; _i<_records.length; _i++) {
                            var _current_record = _records[_i];
                            var _name_found = false;
                            if(_current_record["name"]) {
                                _name_found = true;
                            }

                            var _name = _current_record["name"];
                            var _column_name = _primary_key_auto_increment;
                            var _column_value = _current_record[_column_name];
                            var _quick_replace_class_name = "quick-replace-table-name-" + _table_name + "-column-name-" + _column_name + "-id-" + _column_value;

                            var _quick_replace_elements = document.getElementsByClassName(_quick_replace_class_name);
                            for(var _j=0;_j<_quick_replace_elements.length;_j++) {
                                removeAllChildElements(_quick_replace_elements[_j]);
                                var _quick_replace_text;
                                if(_name_found) {
                                    _quick_replace_text = document.createTextNode(_name);
                                } else {
                                    _quick_replace_text = document.createTextNode(_column_value);
                                }
                                _quick_replace_elements[_j].appendChild(_quick_replace_text);
                            }
                        }
                    }
                    send_http_request(_params, _callback_function);
                }

                if(should_refresh_page) {
                    setTimeout(refresh_page_function(navigate_to_view_table, input_params), 10000);
                }
            }
        }
        send_http_request(params, callback_function);
    }

    load_table_names = function() {
        var params = {"[queue]": "GetTableNames"};
        var callback_function = function(result) {
            if(result["[errors]"]) {
                return;
            }

            leftHandNav = document.getElementById("menu");
            removeAllChildElements(leftHandNav);

            const span = document.createElement("span");
            const length = result["data"].length
            for(var i = 0; i < length; i++) {
                var table_name = encodeURIComponent((result["data"][i]).replace(/"/g, "\\\""));
                const button = document.createElement("button");
                var _params = {};
                _params["table_name"] = table_name;
                _params["page_index"] = 0;
                button.onclick = navigate_to_page_function(navigate_to_view_table, _params);
                button.setAttribute("class", "button menu col-3 col-s-3");
                const text = document.createTextNode(table_name);
                button.appendChild(text);
                span.appendChild(button);
            }
            leftHandNav.appendChild(span);
        }
        send_http_request(params, callback_function);
    }

    draw_top_menu = function(page_name) {
        header_content = document.getElementById("header");
        removeAllChildElements(header_content);

        top_menus_element = document.createElement("div");
        top_menus_element.setAttribute("id", "top_menu");
        top_menus_element.setAttribute("class", "top_menu");

        const span = document.createElement("span");
        var home_button_text = encodeURIComponent("Home");
        const home_button = document.createElement("button");
        home_button.setAttribute("onclick", "navigate_to_home_page()");
        if(page_name == "Home"){
            home_button.setAttribute("class", "top_navigation_button top_menu col-3 col-s-3 enabled");
        } else {
            home_button.setAttribute("class", "top_navigation_button top_menu col-3 col-s-3");
        }
        const home_text = document.createTextNode(home_button_text);
        home_button.appendChild(home_text);
        span.appendChild(home_button);

        var tables_button_text = encodeURIComponent("Tables");
        const tables_button = document.createElement("button");
        tables_button.setAttribute("onclick", "navigate_to_tables_page()");
        if(page_name == "Tables"){
            tables_button.setAttribute("class", "top_navigation_button top_menu col-3 col-s-3 enabled");
        } else {
            tables_button.setAttribute("class", "top_navigation_button top_menu col-3 col-s-3");
        }
        const tables_text = document.createTextNode(tables_button_text);
        tables_button.appendChild(tables_text);
        span.appendChild(tables_button);

        top_menus_element.appendChild(span);

        header_content.appendChild(top_menus_element);
    }

    navigate_to_tables_page = function() {
        reset_view_state();
        document.title = "Holistic Tables page";
        main_content = document.getElementById("main");
        removeAllChildElements(main_content);
        draw_top_menu("Tables");

        menus_element = document.createElement("div");
        menus_text = document.createTextNode("loading...");
        menus_element.appendChild(menus_text);
        menus_element.setAttribute("id", "menu");
        menus_element.setAttribute("class", "menu col-12 col-s-12");

        spacer_element = document.createElement("br");
        spacer_element.setAttribute("class", "col-12 col-s-12");
        main_content.appendChild(spacer_element);
        main_content.appendChild(menus_element);
        load_table_names();
        document.getElementById("top_menu").focus();
    }

    create_record_branch_instance = function(identifier) {
        var button_id = "build_branch_id_button_" + identifier["branch_id"];
        var button = document.getElementById(button_id);
        button.setAttribute("disabled", true);
        var params = {"[queue]":"CreateRecord_BranchInstance", "data":identifier};
        var callback_function = function(result) {
            button.removeAttribute("disabled");
            if(result["[errors]"]) {
                return;
            }
        }
        send_http_request(params, callback_function);
    }            
   
    load_repositories_for_repository_account = function(repository_account_id) {
        var params = {"[queue]":"ReadRecords_Repository","[select_fields]":["repository_id","name"],"[where_fields]":[{"column":"repository_account_id","value":repository_account_id,"logic":"="}]};
        var callback_function = function(result) {
            if(result["[errors]"]) {
                return;
            }

            var content_column_1 = document.getElementById("repositories_list_1");
            var content_column_2 = document.getElementById("repositories_list_1");
            var content_column_3 = document.getElementById("repositories_list_3");
            var content_column_4 = document.getElementById("repositories_list_4");
            var content_column_5 = document.getElementById("repositories_list_5");

            if(!content_column_1 || !content_column_2 || !content_column_3 || !content_column_4 || !content_column_5) {
                return;
            }

            removeAllChildElements(content_column_1);
            removeAllChildElements(content_column_2);
            removeAllChildElements(content_column_3);
            removeAllChildElements(content_column_4);
            removeAllChildElements(content_column_5);

            const length = result["data"].length
            var column_count = 1;
            for(var i = 0; i < length; i++) {
                var record = result["data"][i];
                var name = record["name"];
                name = encodeURIComponent(name.replace(/"/g, "\\\""));
                var repository_id = record["repository_id"];
                const button = document.createElement("button");
                {
                    var _params = {};
                    var _where_fields_value_array = [];
                    var _repository_id_where = {};
                    _repository_id_where["column"] = "repository_id";
                    _repository_id_where["value"] = repository_id;
                    _repository_id_where["logic"] = "=";
                    _where_fields_value_array.push(_repository_id_where);
                    _params["table_name"] = "Branch";
                    _params["page_index"] = 0;
                    _params["where_fields"] = _where_fields_value_array;
                    button.onclick = navigate_to_page_function(navigate_to_view_table, _params);
                }

                //button.setAttribute("onclick", "load_branches_for_repository(" + repository_id  + ")");
                button.setAttribute("class", "button menu");
                const text = document.createTextNode(name);
                button.appendChild(text);
                if(column_count == 1) {
                    content_column_1.appendChild(button);
                } else if(column_count == 2) {
                    content_column_2.appendChild(button);
                } else if(column_count == 3) {
                    content_column_3.appendChild(button);
                } else if(column_count == 4) {
                    content_column_4.appendChild(button);
                } else if(column_count == 5) {
                    content_column_5.appendChild(button);
                }

                column_count++;
                if(column_count > 5) {
                    column_count = 1;
                }
            }
            
            main_content = document.getElementById("main");
            spacer_element = document.createElement("br");
            spacer_element.setAttribute("class", "col-12 col-s-12");
            main_content.appendChild(spacer_element);

            branches_content = document.createElement("div");
            branches_content.setAttribute("id", "branches");
            branches_content.setAttribute("class", "menu col-12 col-s-12");
            main_content.appendChild(branches_content);
        }
        send_http_request(params, callback_function);
    }

    load_repository_accounts_for_domain = function(domain_name_id) {
        var params = {"[queue]":"ReadRecords_RepositoryAccount","[select_fields]":["repository_account_id","domain_name_id","name"],"[where_fields]":[{"column":"domain_name_id","value":domain_name_id,"logic":"="}]};
        var callback_function = function(result) {
            if(result["[errors]"]) {
                return;
            }

            var content = document.getElementById("repository_accounts_list");
            if(!content) {
                return;
            }

            removeAllChildElements(content);
            const length = result["data"].length
            for(var i = 0; i < length; i++) {
                var record = result["data"][i];
                var name = record["name"];
                name = encodeURIComponent(name.replace(/"/g, "\\\""));
                var repository_account_id = record["repository_account_id"];
                const button = document.createElement("button");
                button.setAttribute("onclick", "load_repositories_for_repository_account(" + repository_account_id  + ")");
                button.setAttribute("class", "button menu");
                const text = document.createTextNode(name);
                button.appendChild(text);
                content.appendChild(button);
            }

            spacer_element = document.createElement("br");
            spacer_element.setAttribute("class", "col-12 col-s-12");
            content.appendChild(spacer_element);

            repository_content = document.createElement("div");
            repository_content.setAttribute("id", "repositories");
            repository_content.setAttribute("class", "menu col-12 col-s-12");
            content.appendChild(repository_content);
        }
        send_http_request(params, callback_function);
    }

    load_domain_names = function() {
        var params = {"[queue]":"ReadRecords_DomainName","[select_fields]":["domain_name_id","name"]};
        var callback_function = function(result) {
            if(result["[errors]"]) {
                return;
            }

            var content = document.getElementById("domain_list");
            if(!content) {
                return;
            }

            removeAllChildElements(content);
           

            const length = result["data"].length
            for(var i = 0; i < length; i++) {
                var record = result["data"][i];
                var name = record["name"];
                name = encodeURIComponent(name.replace(/"/g, "\\\""));
                var domain_name_id = record["domain_name_id"];
                const button = document.createElement("button");
                button.setAttribute("onclick", "load_repository_accounts_for_domain(" + domain_name_id  + ")");
                button.setAttribute("class", "button menu");
                const text = document.createTextNode(name);
                button.appendChild(text);
                content.appendChild(button);
            }
        }
        send_http_request(params, callback_function);
    }

    stop_build = function(payload) {
        payload["build_step_status_id"] = build_step_status_name_lookup["Stopped"]["build_step_status_id"];
        
        var queue = "UpdateRecord_";
        if(payload["branch_instance_id"]) {
            queue += "BranchInstance";
        } else {
            return;
        }

        if(payload["branch_instance_id"]) {
            branch_instance_button = document.getElementById("branch_instance_build_status_button" + payload["branch_instance_id"]);
            if(branch_instance_button) {
                branch_instance_button.parentElement.removeChild(branch_instance_button);
            }
        }
        
        var params = {"[queue]":queue, "data":payload};
        var callback_function = function(result) {
            if(result["[errors]"]) {
                return;
            }
        }
        send_http_request(params, callback_function);
    }

    translate_step_name = function(name) {
        name = name.replace("Run_","");
        name = name.replace("Create", "+");
        name = name.replace("Assign", "+");
        name = name.replace("Delete", "-");
        name = name.replace("Remove", "-");
        name = name.replace("Pull", "▼");
        name = name.replace("Clone", "▼");
        name = name.replace("Folder", "");
        name = name.replace("▼BranchOrTag", "▼Clone");
        name = name.replace("▼LatestBranchOrTag", "▼Pull");
        name = name.replace("To", ">");
        name = name.replace("From", "<");
        name = name.replace("RepositoryAccount", "Account");
        return name;
    }

    append_build_step_status_colour = function(element, name) {
        if(!element.getAttribute("style")) {
            element.setAttribute("style", "");
        }

        switch(name) {
        case "Not Started":
            element.setAttribute("style", element.getAttribute("style") + " background-color:grey; color:white; width:100%; border-bottom-style: solid; border-bottom-color: white;");
            break;
        case "Running":
            element.setAttribute("style", element.getAttribute("style") + " background-color:blue; color:white; width:100%; border-bottom-style: solid; border-bottom-color: white;");
            break;
        case "Passed":
            element.setAttribute("style", element.getAttribute("style") + " background-color:seagreen; color:white; width:100%; border-bottom-style: solid; border-bottom-color: white;");
            break;
        case "Failed":
            element.setAttribute("style", element.getAttribute("style") + " background-color:lightpink; color:white; width:100%; border-bottom-style: solid; border-bottom-color: white;");
            break;
        default:
            break;
       }
    }

    poll_console_output = function(payload) {
        if(!payload["branch_instance_id"]) {
            return;
        }

        if(current_branch_instance_id != payload["branch_instance_id"]) {
            return;
        }

        var console_span = document.getElementById("console_output_branch_instance_id" + payload["branch_instance_id"]);
        if(!console_span) {
            return;
        }

        var params = {"[queue]":"ReadRecords_BranchInstanceStepLog","[select_fields]":["branch_instance_step_log_id", "log","stdout"],"[where_fields]":[{"column":"branch_instance_id","value":payload["branch_instance_id"],"logic":"="},{"column":"branch_instance_step_log_id","value":current_branch_instance_step_log_id,"logic":">"}],"[order_by]":[{"branch_instance_step_log_id":"ascending"}],"[limit]":10};
        var callback_function = function(result) {
            if(result["[errors]"]) {
                setTimeout(poll_console_output, 2000, payload);
                return;
            }

            var console_span = document.getElementById("console_output_branch_instance_id" + payload["branch_instance_id"]);
            if(!console_span) {
                return;
            }

            var length = result["data"].length;
            for(var i = 0; i < length; i++) {
                var console_output = document.createElement("div");
                console_output.setAttribute("class", "terminal-output font-size-xx-small")
                var console_output_text = document.createTextNode(result["data"][i]["log"]);
                console_output.appendChild(console_output_text);
                console_span.prepend(console_output);
            }

            if(length > 0) {
                current_branch_instance_step_log_id = result["data"][length-1]["branch_instance_step_log_id"];
            }
            setTimeout(poll_console_output, 2000, payload);
        }
        send_http_request(params, callback_function);
    }

    show_build = function(payload) {   
        if(current_branch_instance_id == 0) {
            return;
        }
                
        var params = {"[queue]":"ReadRecords_BranchInstanceStep","[select_fields]":["build_step_id","build_step_group_id","build_step_status_id","order","parameters"],"[where_fields]":[{"column":"branch_instance_id","value":payload["branch_instance_id"],"logic":"="}],"[order_by]":[{"branch_instance_step_id":"ascending"},{"order":"ascending"}]};
        var callback_function = function(result) {
            if(current_branch_instance_id == 0) {
                return;
            }

            if(result["[errors]"]) {
                return;
            }

            for(var i=0; i < result["data"].length; i++) {
                result["data"][i]["build_step_status_name"] = build_step_status_lookup[result["data"][i]["build_step_status_id"]]["name"];
                result["data"][i]["build_step_name"] = build_step_lookup[result["data"][i]["build_step_id"]]["name"];
                result["data"][i]["build_step_group_name"] = build_step_group_lookup[result["data"][i]["build_step_group_id"]]["name"];
            }

            var setup = [];
            var run = [];
            var teardown = [];
            var current_order = null;

            for(var i=0; i < result["data"].length; i++) {
                var current_record = result["data"][i];
                if(current_record["build_step_group_name"] == "Setup") {
                    setup.push(current_record);
                } else if (current_record["build_step_group_name"] == "Teardown") {
                    teardown.push(current_record);
                } else {
                    compare_order = current_record["order"];
                    if(current_order == null || compare_order > current_order) {
                        current_order = compare_order;
                        
                        if(!(current_record["build_step_name"] === "Run_IntegrationTestSuite" ||
                           current_record["build_step_name"] === "Run_Sync")) {
                            var new_array = [];
                            run.push(new_array);
                        }
                        run[run.length-1].push(current_record);
                    } else {
                        run[run.length-1].push(current_record);
                    }
                }
            }

            const setup_span = document.createElement("span");
            setup_span.setAttribute("class", "col-1 col-s-1");

            const teardown_span = document.createElement("span");
            teardown_span.setAttribute("class", "col-1 col-s-1");

            var run_spans = [];

            for(var i=0; i<setup.length; i++) {
                const button = document.createElement("span");
                button.setAttribute("class", "font-size-xx-small truncate col-1 col-s-1");
                append_build_step_status_colour(button, setup[i]["build_step_status_name"]);
                button_text = document.createTextNode(translate_step_name(setup[i]["build_step_name"]));
                button.appendChild(button_text);
                setup_span.appendChild(button);
            }

            for(var i=0;i<run.length;i++) {
                var current_run_column = run[i];
                const span_col = document.createElement("span");                
                var found_tests = false;
                for(var j=0; j<current_run_column.length; j++) {
                    const button = document.createElement("span");
                    button.setAttribute("class", "font-size-xx-small truncate col-1 col-s-1");
                    append_build_step_status_colour(button, current_run_column[j]["build_step_status_name"]);
                    var button_text = "";
                    if(current_run_column[j]["build_step_name"] !== "Run_IntegrationTestSuite") {
                        button_text = document.createTextNode((current_run_column[j]["build_step_name"]).replace("Run_", ""));
                    } else {
                        var test_suite_name = JSON.parse(current_run_column[j]["parameters"])["test_suite_name"];
                        test_suite_name = test_suite_name.replace("_Integration_test.go", "");
                        if(test_suite_name.indexOf("/") !== -1) {
                            var test_suite_name_parts = test_suite_name.split("/");
                            test_suite_name = test_suite_name_parts[(test_suite_name_parts.length)-1];
                        }
                        button_text = document.createTextNode(test_suite_name);
                    }

                    button.appendChild(button_text);
                    span_col.appendChild(button);

                    if(current_run_column[j]["build_step_name"] === "Run_IntegrationTests") {
                        found_tests = true;
                    }
                }

                span_col.setAttribute("class", "col-1 col-s-1");
                run_spans.push(span_col);
            }

            for(var i=0; i<teardown.length; i++) {
                const button = document.createElement("span");
                button.setAttribute("class", "font-size-xx-small truncate col-1 col-s-1");
                append_build_step_status_colour(button, teardown[i]["build_step_status_name"]);
                button_text = document.createTextNode(translate_step_name(teardown[i]["build_step_name"]));
                button.appendChild(button_text);
                teardown_span.appendChild(button);
            }

            var build_content = document.getElementById("build_id");
            if(!build_content) {
                build_content = document.createElement("span");
                build_content.setAttribute("id", "build_id");
                document.getElementById("main").appendChild(build_content);
            }
            removeAllChildElements(build_content);
           
            build_content.appendChild(setup_span);
            for(var i=0; i < run_spans.length; i++) {
                build_content.appendChild(run_spans[i]);
            }
            build_content.appendChild(teardown_span);

            if(payload["branch_instance_id"]) {
                console_span = document.getElementById("console_output_branch_instance_id" + payload["branch_instance_id"]);
                if(!console_span) {
                    console_span = document.createElement("span");
                    console_span.setAttribute("class", "col-6 col-s-6");
                    if(payload["branch_instance_id"]) {
                        console_span.setAttribute("id", "console_output_branch_instance_id" + payload["branch_instance_id"]);
                    }
                    document.getElementById("main").appendChild(console_span);
                    current_branch_instance_step_log_id = 0;
                    setTimeout(poll_console_output, 1, payload);
                }
            }
            setTimeout(show_build, 5000, payload);
        }
        send_http_request(params, callback_function);
    }

    var emit_show_build = function(payload) {
        reset_view_state();
        var content = document.getElementById("main");
        removeAllChildElements(content);
        current_branch_instance_id = payload["branch_instance_id"];
        show_build(payload);
    }

    refresh_build_respositories = function(branch_instances) {
        var respostory_ids = {}
        var respostory_ids_array = [];
        var respostory_ids_array_length = branch_instances.length;
        for(var i = 0; i < respostory_ids_array_length; i++) {
            current_record = branch_instances[i];
            current_repository_id = current_record["repository_id"];
            if(!respostory_ids[current_repository_id]) {
                respostory_ids[current_repository_id] = current_record;
                respostory_ids_array.push(current_repository_id);
            }
        }

        var params = {"[queue]":"ReadRecords_Repository","[select_fields]":["repository_id","name"],"[where_fields]":[{"column":"repository_id","value":respostory_ids_array,"logic":"in"}]};
        var callback_function = function(result) {
            if(result["[errors]"]) {
                setTimeout(refresh_build_activity, 10000);
                return;
            }

            var respositories = {};
            for(var i = 0; i < result["data"].length; i++) {
                var current_repository = result["data"][i];
                if(!respositories[current_repository["repository_id"]]) {
                    respositories[current_repository["repository_id"]] = current_repository;
                }
            }

            const span = document.createElement("span");
            const length = branch_instances.length
            for(var i = 0; i < length; i++) {
                var record = branch_instances[i];
                var branch_instance_id = record["branch_instance_id"];
                var repository_name = respositories[record["repository_id"]]["name"];
                var branch_name = record["branch_name"]
                var build_step_status_id = null;
                build_step_status_id = record["build_step_status_id"];
                const button = document.createElement("button");
                button.setAttribute("class", "button menu col-3 col-s-3");
                button.setAttribute("id", "branch_instance_build_status_button" + branch_instance_id);

                if(build_step_status_lookup[build_step_status_id]) {
                    build_step_status_id = build_step_status_lookup[build_step_status_id]["icon"];
                }

                var cancel_icon = document.createElement("span");
                cancel_icon.setAttribute("style", "color:red;")
                cancel_icon.innerHTML = "&#9746;";

                var target_identifier = {};
                target_identifier["branch_instance_id"] = branch_instance_id;

                var show_build_visial = function (target_identifier) {
                    var _id = Object.assign({}, target_identifier);
                    var x = function() {
                        emit_show_build(_id);
                    }
                    return x;
                }

                var show_build_visial_instance = show_build_visial(target_identifier);
                button.onclick = show_build_visial_instance;

                var stop_build_function = function (target_identifier) {
                    var _id = Object.assign({}, target_identifier);
                    var x = function() {
                        stop_build(_id);
                    }
                    return x;
                }

                var stop_build_function_instance = stop_build_function(target_identifier);

                cancel_icon.onclick = stop_build_function_instance;

                button.appendChild(cancel_icon);

                const text = document.createTextNode(repository_name + " [" + branch_name + "] #" + branch_instance_id + " - ")
                button.appendChild(text);
                var icon = document.createElement("span");
                icon.innerHTML = build_step_status_id;
                button.appendChild(icon);
                
                var metrics = record["metrics"];

                var passed_count = 0.0;
                var failed_count = 0.0;
                var running_count = 0.0;
                var not_started_count = 0.0;
                var total_count = 0.0;
                
                if(metrics && metrics["Passed"]){
                    passed_count = metrics["Passed"];
                    total_count += (passed_count * 1.0);
                }

                if(metrics && metrics["Failed"]){
                    failed_count = metrics["Failed"];
                    total_count += (failed_count * 1.0);
                }

                if(metrics && metrics["Running"]){
                    running_count = metrics["Running"];
                    total_count += (running_count * 1.0);
                }

                if(metrics && metrics["Not Started"]){
                    not_started_count = metrics["Not Started"];
                    total_count += (not_started_count * 1.0);
                }

                if(total_count == 0) {
                    total_count = 1;
                    not_started_count = 1;
                }

                progress_bar = document.createElement("div");
                progress_bar.setAttribute("style", "width:100%; height:20px;");
                
                passed_progress_bar = document.createElement("div");
                passed_progress_bar.setAttribute("style", "width:" + ((passed_count/total_count)* 100.0)  + "%; background-color:green; height:80%; display:inline-block;");

                failed_progress_bar = document.createElement("div");
                failed_progress_bar.setAttribute("style", "width:" + ((failed_count/total_count * 100.0))  + "%; background-color:red; height:80%; display:inline-block;");

                running_progress_bar = document.createElement("div");
                running_progress_bar.setAttribute("style", "width:" + ((running_count/total_count * 100.0))  + "%; background-color:blue; height:80%; display:inline-block;");

                not_started_bar = document.createElement("div");
                not_started_bar.setAttribute("style", "width:" + ((not_started_count/total_count * 100.0))  + "%; background-color:grey; height:80%; display:inline-block;");

                progress_bar.appendChild(passed_progress_bar);
                progress_bar.appendChild(failed_progress_bar);
                progress_bar.appendChild(running_progress_bar);
                progress_bar.appendChild(not_started_bar);

                button.appendChild(progress_bar);
                span.appendChild(button);
            }

            content = document.getElementById("footer");
            removeAllChildElements(content);
            content.appendChild(span);
            setTimeout(refresh_build_activity, 10000);
        }
        send_http_request(params, callback_function);
    }

    refresh_build_branches = function(branch_instances) {
        var branch_ids = {}
        var branch_ids_array = [];
        var branch_instances_length = branch_instances.length;
        for(var i = 0; i < branch_instances_length; i++) {
            current_record = branch_instances[i];
            current_branch_id = current_record["branch_id"];
            if(!branch_ids[current_branch_id]) {
                branch_ids[current_branch_id] = current_record;
                branch_ids_array.push(current_branch_id);
            }
        }

        var params = {"[queue]":"ReadRecords_Branch","[select_fields]":["branch_id","name","repository_id"],"[where_fields]":[{"column":"branch_id","value":branch_ids_array,"logic":"in"}]};
        var callback_function = function(result) {
            if(result["[errors]"]) {
                setTimeout(refresh_build_activity, 10000);
                return;
            }

            var branches = {};
            for(var i = 0; i < result["data"].length; i++) {
                var current_branch = result["data"][i];
                if(!branches[current_branch["branch_id"]]) {
                    branches[current_branch["branch_id"]] = current_branch;
                }
            }

            for(var i = 0; i < branch_instances.length; i++) {
                current_branch_instance = branch_instances[i];
                current_branch_instance["branch_name"] = branches[current_branch_instance["branch_id"]]["name"];
                current_branch_instance["repository_id"] = branches[current_branch_instance["branch_id"]]["repository_id"];
            }
            refresh_build_respositories(branch_instances);
        }
        send_http_request(params, callback_function);
    }

    refresh_branch_instance_steps = function(branch_instances) {
        var ids = {}
        var ids_array = [];
        var ids_array_length = branch_instances.length;
        for(var i = 0; i < ids_array_length; i++) {
            current_record = branch_instances[i];
            current_id = current_record["branch_instance_id"];
            if(!ids[current_id]) {
                ids[current_id] = current_record;
                ids_array.push(current_id);
            }
        }

        var params = {"[queue]":"ReadRecords_BranchInstanceStep","[select_fields]":["branch_instance_id","build_step_status_id","COUNT(*)"],"[where_fields]":[{"column":"branch_instance_id","value":ids_array,"logic":"in"}],"[group_by]":["branch_instance_id","build_step_status_id"]};
        var callback_function = function(result) {
            if(result["[errors]"]) {
                setTimeout(refresh_build_activity, 10000);
                return;
            }

            var metrics = {};
            for(var i = 0; i < result["data"].length; i++) {
                var current = result["data"][i];
                var branch_instance_id = current["branch_instance_id"];
                var build_step_status_id = current["build_step_status_id"];
                var count = current["COUNT(*)"];
                if(!metrics[branch_instance_id]) {
                    var metric = {};
                    metrics[branch_instance_id] = metric;
                }

                metrics[branch_instance_id][build_step_status_lookup[build_step_status_id]["name"]] = count;
            }

            for(var i = 0; i < branch_instances.length; i++) {
                current_branch_instance = branch_instances[i];
                current_branch_instance["metrics"] = metrics[current_branch_instance["branch_instance_id"]];
            }

            refresh_build_branches(branch_instances);
        }
        send_http_request(params, callback_function);
    }

    refresh_build_activity = function() {
        var build_step_status_ids_array = [];
        build_step_status_ids_array.push(build_step_status_name_lookup["Not Started"]["build_step_status_id"]);
        build_step_status_ids_array.push(build_step_status_name_lookup["Running"]["build_step_status_id"]);

        var params = {"[queue]":"ReadRecords_BranchInstance","[select_fields]":["branch_instance_id", "branch_id", "build_step_status_id"], "[where_fields]":[{"column":"build_step_status_id","value":build_step_status_ids_array,"logic":"in"}]};
        var callback_function = function(result) {
            if(result["[errors]"]) {
                setTimeout(refresh_build_activity, 10000);
                return;
            }

            var branch_instances = result["data"];
            if(branch_instances.length > 0){
                refresh_branch_instance_steps(branch_instances);
            } else {
                content = document.getElementById("footer");
                removeAllChildElements(content);
                setTimeout(refresh_build_activity, 10000);
            }
        }
        send_http_request(params, callback_function);
    }

    navigate_to_home_page = function(input_params) {
        reset_view_state();
        document.title = "Holistic Home page";
        main_content = document.getElementById("main");
        removeAllChildElements(main_content);
        draw_top_menu("Home");

        column_1 = document.createElement("div");
        column_1.setAttribute("class", "menu col-2 col-s-2");
        var domain_name_label = document.createElement("div");
        var domain_name_label_text = document.createTextNode("sources");
        domain_name_label.appendChild(domain_name_label_text);
        column_1.appendChild(domain_name_label);
        var domain_name_elements = document.createElement("div");
        domain_name_elements.setAttribute("id", "domain_list");
        column_1.appendChild(domain_name_elements);

        var repository_accounts_label = document.createElement("div");
        var repository_accounts_label_text = document.createTextNode("accounts");
        repository_accounts_label.appendChild(repository_accounts_label_text);
        column_1.appendChild(repository_accounts_label);
        var repository_accounts_elements = document.createElement("div");
        repository_accounts_elements.setAttribute("id", "repository_accounts_list");
        column_1.appendChild(repository_accounts_elements);
        
        main_content.appendChild(column_1);


        column_2 = document.createElement("div");
        column_2.setAttribute("class", "menu col-2 col-s-2");
        var repositories_column_label_1 = document.createElement("div");
        var repositories_column_label_text_1 = document.createTextNode("repositories");
        repositories_column_label_1.appendChild(repositories_column_label_text_1);
        column_2.appendChild(repositories_column_label_1);
        var repositories_elements_1 = document.createElement("div");
        repositories_elements_1.setAttribute("id", "repositories_list_1");
        column_2.appendChild(repositories_elements_1);
        main_content.appendChild(column_2);

        column_3 = document.createElement("div");
        column_3.setAttribute("class", "menu col-2 col-s-2");
        var spacer = document.createElement("br");
        spacer.setAttribute("class", "col-2 col-s-2");
        column_3.appendChild(spacer);
        var repositories_elements_2 = document.createElement("div");
        repositories_elements_2.setAttribute("id", "repositories_list_2");
        column_3.appendChild(repositories_elements_2);
        main_content.appendChild(column_3);

        column_4 = document.createElement("div");
        column_4.setAttribute("class", "menu col-2 col-s-2");
        var spacer_2 = document.createElement("br");
        spacer_2.setAttribute("class", "col-2 col-s-2");
        column_4.appendChild(spacer_2);
        var repositories_elements_3 = document.createElement("div");
        repositories_elements_3.setAttribute("id", "repositories_list_3");
        column_4.appendChild(repositories_elements_3);
        main_content.appendChild(column_4);


        column_5 = document.createElement("div");
        column_5.setAttribute("class", "menu col-2 col-s-2");
        var spacer_3 = document.createElement("br");
        spacer_3.setAttribute("class", "col-2 col-s-2");
        column_5.appendChild(spacer_3);
        var repositories_elements_4 = document.createElement("div");
        repositories_elements_4.setAttribute("id", "repositories_list_4");
        column_5.appendChild(repositories_elements_4);
        main_content.appendChild(column_5);

        column_6 = document.createElement("div");
        column_6.setAttribute("class", "menu col-2 col-s-2");
        var spacer_4 = document.createElement("br");
        spacer_4.setAttribute("class", "col-2 col-s-2");
        column_6.appendChild(spacer_4);
        var repositories_elements_5 = document.createElement("div");
        repositories_elements_5.setAttribute("id", "repositories_list_5");
        column_6.appendChild(repositories_elements_5);
        main_content.appendChild(column_6);


        document.getElementById("top_menu").focus();
        load_domain_names();
    }

    get_build_step_status_lookup = function() {
        var params = {"[queue]":"ReadRecords_BuildStepStatus","[select_fields]":["build_step_status_id","name"]};
        var callback_function = function(result) {
            if(result["[errors]"]) {
                return;
            }

           
            for(var i = 0; i < result["data"].length; i++) {
                var record = result["data"][i];
                
                if(record["name"] == "Not Started") {
                    record["icon"] = "&#8987;" 
                } else if (record["name"] == "Running") {
                    record["icon"] = "&#128640;" 
                }

                if(!build_step_status_lookup[record["build_step_status_id"]]) {
                    build_step_status_lookup[record["build_step_status_id"]] = record;
                }

                if(!build_step_status_name_lookup[record["name"]]) {
                    build_step_status_name_lookup[record["name"]] = record;
                }
            }
        }
        send_http_request(params, callback_function);
    }

    get_build_step_group_lookup = function() {
        var params = {"[queue]":"ReadRecords_BuildStepGroup","[select_fields]":["build_step_group_id","name"]};
        var callback_function = function(result) {
            if(result["[errors]"]) {
                return;
            }

            for(var i = 0; i < result["data"].length; i++) {
                var record = result["data"][i];

                if(!build_step_group_lookup[record["build_step_group_id"]]) {
                    build_step_group_lookup[record["build_step_group_id"]] = record;
                }

                if(!build_step_group_name_lookup[record["name"]]) {
                    build_step_group_name_lookup[record["name"]] = record;
                }
            }
        }
        send_http_request(params, callback_function);
    }

    get_build_step_lookup = function() {
        var params = {"[queue]":"ReadRecords_BuildStep","[select_fields]":["build_step_id","name"]};
        var callback_function = function(result) {
            if(result["[errors]"]) {
                return;
            }

            for(var i = 0; i < result["data"].length; i++) {
                var record = result["data"][i];

                if(!build_step_lookup[record["build_step_id"]]) {
                    build_step_lookup[record["build_step_id"]] = record;
                }

                if(!build_step_name_lookup[record["name"]]) {
                    build_step_name_lookup[record["name"]] = record;
                }
            }
        }
        send_http_request(params, callback_function);
    }
    
    get_build_step_lookup();
    get_build_step_group_lookup();
    get_build_step_status_lookup();
    setTimeout(refresh_build_activity, 5000);
    var dummy_params = {};
    navigate_to_page(navigate_to_home_page, dummy_params);

</script>
